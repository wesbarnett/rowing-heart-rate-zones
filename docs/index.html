<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Heart Rate Zone Calculator</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 400px; }
    label { display: block; margin-top: 10px; }
    input { width: 100%; padding: 8px; margin-top: 5px; }
    button { margin-top: 15px; padding: 10px; width: 100%; cursor: pointer; }
    .result-box {
        margin-top: 20px;
        font-weight: bold;
        font-size: 1.2em;
    }
    .error {
        color: red;
    }
    .formula { margin-top: 20px; font-style: italic; font-size: 0.9em; color: #555; }
  </style>
</head>
<body>
  <h2>Rowing Heart Rate Zones Calculator</h2>

  <div>Enter your age to calculate maximum heart rate, or enter maximum heart rate directly.</div>

  <label for="age">Age (years):</label>
  <input type="number" id="age" placeholder="Enter age">

  <label for="mhrInput">Maximum Heart Rate (bpm):</label>
  <input type="number" id="mhrInput" placeholder="Auto-calculated if age entered">

  <label for="rhr">Resting Heart Rate (bpm):</label>
  <input type="number" id="rhr" placeholder="Enter resting heart rate">

  <button type="button" onclick="calculateZone()">Calculate</button>

  <div class="error" id="error"></div>
  <div class="result-box" id="result_UT2">UT2:</div>
  <div class="result-box" id="result_UT1">UT1:</div>
  <div class="result-box" id="result_AT">AT:</div>
  <div class="result-box" id="result_TR">TR:</div>

  <script>
    window.addEventListener('DOMContentLoaded', () => {
        const savedAge = localStorage.getItem('age');
        const savedRHR = localStorage.getItem('rhr');
        const savedMHR = localStorage.getItem('mhr');
        if (savedAge) document.getElementById('age').value = savedAge;
        if (savedRHR) document.getElementById('rhr').value = savedRHR;
        if (savedMHR) document.getElementById('mhrInput').value = savedMHR;
        if (savedRHR && savedMHR) calculateZone();

    });
    document.getElementById('age').addEventListener('input', () => {
      const age = parseFloat(document.getElementById('age').value);
      if (!isNaN(age)) {
          let calculated;
          if (age < 31) {
              calculated = 220 - age;
          } else {
              calculated = 190 - (age - 30) / 2;
          }
          document.getElementById('mhrInput').value = calculated.toFixed(0);
      }
    });
    function calculateZone() {
      const age = parseFloat(document.getElementById('age').value);
      const rhr = parseFloat(document.getElementById('rhr').value);
      let userMHR = parseFloat(document.getElementById('mhrInput').value);

      const target_59 = (userMHR - rhr) * 0.59 + rhr;
      const target_67 = (userMHR - rhr) * 0.67 + rhr;
      const target_75 = (userMHR - rhr) * 0.75 + rhr;
      const target_85 = (userMHR - rhr) * 0.85 + rhr;
      document.getElementById('result_UT2').innerText = `UT2: ${target_59.toFixed(0)} - ${target_67.toFixed(0)} bpm`;
      document.getElementById('result_UT1').innerText = `UT1: ${target_67.toFixed(0)} - ${target_75.toFixed(0)} bpm`;
      document.getElementById('result_AT').innerText = `AT: ${target_75.toFixed(0)} - ${target_85.toFixed(0)} bpm`;
      document.getElementById('result_TR').innerText = `TR: ${target_85.toFixed(0)} - ${userMHR.toFixed(0)} bpm`;
      localStorage.setItem('age', age);
      localStorage.setItem('rhr', rhr);
      localStorage.setItem('mhr', userMHR);
    }
  </script>
  <br>
  <h4>About</h4>
  <div>The formula used for each zone above is:</div>
  <div class="formula">(MHR - RHR) * % + RHR</div>
  <br>
  <div>The maximum heart rate (MHR) is calculated using the age input. Every year 30 and below is expected to decrease maximum heart rate by one from a starting value of 220. Every year above age 30 each year counts only half a beat in that difference.</div>
  <br>
  <div>The percentages used are as follows:</div>
  <ul>
      <li>UT2 = 59%-67%</li>
      <li>UT1 = 67%-75%</li>
      <li>AT = 75%-85%</li>
      <li>TR = 85%-100%</li>
  </ul>
</body>
</html>

